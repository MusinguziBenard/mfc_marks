<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="manifest" href="manifest.json">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Text Reader and Audio Downloader</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background-color: #f7f7f7;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      height: 100vh;
      padding: 10px;
      overflow: hidden;
      position: relative;
    }

    h1 {
      font-size: 2rem;
      color: #333;
      text-align: center;
      margin-bottom: 20px;
      font-family: 'Arial', sans-serif;
      width: 100%;
      white-space: nowrap;
      overflow: hidden;
      border-right: 3px solid #333;
      animation: typing 4s steps(30) infinite, blink 2.75s step-end infinite;
    }

    @keyframes typing {
      from {
        width: 0;
      }
      to {
        width: 100%;
      }
    }

    @keyframes blink {
      50% {
        border-color: transparent;
      }
    }

    textarea {
      width: 100%;
      max-width: 900px;
      height: 400px;
      padding: 20px;
      font-size: 18px;
      border-radius: 10px;
      border: 1px solid #ddd;
      margin-bottom: 20px;
      resize: none;
      background-color: #fff;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      font-family: 'Roboto', sans-serif;
      overflow-y: scroll;
      scroll-behavior: smooth;
    }

    .controls {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
      width: 100%;
      max-width: 900px;
    }

    button {
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      background-color: #007bff;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s;
      font-family: 'Roboto', sans-serif;
    }

    button:hover {
      background-color: #0056b3;
    }

    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }

    #audio-player {
      margin-top: 20px;
      max-width: 600px;
      width: 100%;
      display: none;
    }

    #loading {
      font-size: 16px;
      color: #333;
      margin-top: 20px;
      display: none;
      text-align: center;
    }

    .creator {
      margin-top: 30px;
      font-size: 14px;
      color: #007bff;
      text-align: center;
      width: 100%;
      font-family: 'Arial', sans-serif;
      padding: 10px;
      position: fixed;
      bottom: 0;
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 1.5rem;
      }

      .controls {
        flex-direction: column;
        align-items: center;
      }

      button {
        width: 100%;
        margin-bottom: 10px;
      }

      textarea {
        width: 100%;
        height: 250px;
      }
    }
  </style>
</head>
<body>
  <h1>Type/paste Text Here to Read</h1>
  <textarea id="text-input" placeholder="Paste or Enter your text here..."></textarea>
  <div class="controls">
    <button id="read-btn">Read Aloud</button>
    <button id="stop-btn" disabled>Stop Reading</button> <!-- Stop button -->
    <button id="download-btn" disabled>Download Audio</button>
  </div>
  <audio id="audio-player" controls></audio>
  <div id="loading" class="loading">Processing... Please wait.</div>
  <div class="creator">Created by Benard CEO RocheCodeCamp.org</div>

  <script>
    const textInput = document.getElementById('text-input');
    const readBtn = document.getElementById('read-btn');
    const stopBtn = document.getElementById('stop-btn'); // Stop button
    const downloadBtn = document.getElementById('download-btn');
    const audioPlayer = document.getElementById('audio-player');
    const loading = document.getElementById('loading');
    
    const API_KEY = "57d586d05d2449e18b7f1fc19555e5fb"; // Replace with your API key
    let selectedVoice = "en-US";  // Default voice for reading

    // Function to split long text into chunks
    function splitTextIntoChunks(text, maxLength) {
      const chunks = [];
      while (text.length > maxLength) {
        const chunk = text.slice(0, maxLength);
        const lastSpace = chunk.lastIndexOf(" ");
        chunks.push(chunk.slice(0, lastSpace));
        text = text.slice(lastSpace + 1);
      }
      chunks.push(text);
      return chunks;
    }

    // Read text aloud
    readBtn.addEventListener('click', () => {
      const text = textInput.value.trim();
      if (!text) {
        alert('Please enter some text!');
        return;
      }

      const chunks = splitTextIntoChunks(text, 500);  // Split if text is long
      let totalLength = 0;

      for (const chunk of chunks) {
        const utterance = new SpeechSynthesisUtterance(chunk);
        utterance.voice = speechSynthesis.getVoices().find(voice => voice.lang === selectedVoice);
        
        // Auto-select text and scroll
        utterance.onstart = function(event) {
          textInput.setSelectionRange(totalLength, totalLength + chunk.length);
          textInput.scrollTop = textInput.scrollHeight;
          totalLength += chunk.length;
        };

        speechSynthesis.speak(utterance);
      }

      downloadBtn.disabled = false;  // Enable download after reading
      stopBtn.disabled = false; // Enable stop button
    });

    // Stop reading aloud
    stopBtn.addEventListener('click', () => {
      speechSynthesis.cancel();  // Stops any ongoing speech
      stopBtn.disabled = true;  // Disable the stop button after it's clicked
    });

    // Download audio functionality
    downloadBtn.addEventListener('click', async () => {
      const text = textInput.value.trim();
      if (!text) return;

      loading.style.display = 'block';  // Show loading indicator
      try {
        const response = await fetch(`https://api.openai.com/v1/audio/speech-to-text`, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${API_KEY}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ text: text })
        });

        const data = await response.json();
        const audioUrl = data.audio_url;  // Assuming the API gives back an audio URL
        audioPlayer.src = audioUrl;
        audioPlayer.style.display = 'block';  // Show audio player
        loading.style.display = 'none';
      } catch (error) {
        console.error('Error generating audio:', error);
        loading.style.display = 'none';
        alert('Error generating audio. Please try again.');
      }
    });

    // Initial setup
    window.addEventListener('load', () => {
      if (!speechSynthesis) {
        alert('Your browser does not support text-to-speech.');
      }
    });
    
    
    
    
    
 
  // Disable right-click context menu
  document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
    alert("Right-click is disabled on this page.");
  });

  // Disable keyboard shortcuts for developer tools (F12, Ctrl+Shift+I, Ctrl+Shift+J)
  document.addEventListener('keydown', function(e) {
    if (e.key === 'F12' || (e.ctrlKey && (e.shiftKey && (e.key === 'I' || e.key === 'J')))) {
      e.preventDefault();
      alert("Developer tools are disabled on this page.");
    }
  });

  // Detect developer tools open and alert the user
  setInterval(function() {
    if (window.outerWidth - window.innerWidth > 100 || window.outerHeight - window.innerHeight > 100) {
      alert("Developer tools detected. Please close them.");
    }
  }, 1000);

  // Disable text selection (optional)
  document.body.style.webkitUserSelect = "none";
  document.body.style.userSelect = "none";


    
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/service-worker.js')
        .then((registration) => {
          console.log('Service Worker registered with scope:', registration.scope);
        })
        .catch((error) => {
          console.log('Service Worker registration failed:', error);
        });
    });
  }


  
  </script>
</body>
  </html>

